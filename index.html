<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="UTF-8">
    <title>SimpleImpersonation by mj1856</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="stylesheets/normalize.css" media="screen">
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-light.css" media="screen">
  </head>
  <body>
    <section class="page-header">
      <h1 class="project-name">SimpleImpersonation</h1>
      <h2 class="project-tagline">Simple Impersonation Library for .Net</h2>
      <a href="https://github.com/mj1856/SimpleImpersonation" class="btn">View on GitHub</a>
      <a href="https://github.com/mj1856/SimpleImpersonation/zipball/master" class="btn">Download .zip</a>
      <a href="https://github.com/mj1856/SimpleImpersonation/tarball/master" class="btn">Download .tar.gz</a>
    </section>

    <section class="main-content">
      <h1>
<a id="simpleimpersonation" class="anchor" href="#simpleimpersonation" aria-hidden="true"><span class="octicon octicon-link"></span></a>SimpleImpersonation</h1>

<p>Simple Impersonation Library for .Net</p>

<p>This library provides a managed wrapper for the <a href="http://msdn.microsoft.com/en-us/library/windows/desktop/aa378184.aspx">LogonUser</a> function of the Win32 API.  Basically, it allows you to impersonate any user, as long as you have their credentials.</p>

<p>It is dual compiled for both .Net 2.0 and .Net 4.0 runtimes.  It should work well under .Net 2.0, 3.0, 3.5, 4.0, 4.5, 4.5.1, 4.5.2, 4.6, and the 4.0 client profiles.  It has no dependencies.</p>

<p>Note that it is <em>not</em> compiled for PCL or .NET Core, as it is Windows specific.</p>

<h2>
<a id="installation" class="anchor" href="#installation" aria-hidden="true"><span class="octicon octicon-link"></span></a>Installation</h2>

<p>Use NuGet package <a href="https://nuget.org/packages/SimpleImpersonation/">SimpleImpersonation</a>.</p>

<div class="highlight highlight-source-powershell"><pre>PM<span class="pl-k">&gt;</span> <span class="pl-c1">Install-Package</span> SimpleImpersonation</pre></div>

<h2>
<a id="usage" class="anchor" href="#usage" aria-hidden="true"><span class="octicon octicon-link"></span></a>Usage</h2>

<div class="highlight highlight-source-cs"><pre><span class="pl-k">using</span> (Impersonation.LogonUser(domain, username, password, logonType))
{
    <span class="pl-c">// do whatever you want as this user.</span>
}</pre></div>

<p>Note: As of version 1.1.0, <code>password</code> can be specified as a <code>SecureString</code>.  You can still pass a regular <code>string</code> if desired, however <code>SecureString</code> is recommended.</p>

<p>Be sure to specify a logon type that makes sense for what you are doing.  For example:</p>

<ul>
<li><p>If you are interactively working as a particular user from a desktop application, use <code>LogonType.Interactive</code>.</p></li>
<li>
<p>If you are trying to connect to a SQL server with trusted authentication using specific credentials, use <code>LogonType.NewCredentials</code>.</p>

<ul>
<li>But be aware that impersonation is not taken into account in connection pooling.</li>
<li>You will also need to vary your connection string.</li>
<li>Read more <a href="http://stackoverflow.com/q/18198291/634824">here</a>
</li>
</ul>
</li>
</ul>

<p>See the <a href="http://msdn.microsoft.com/library/windows/desktop/aa378184.aspx">MSDN documentation</a> for additional logon types.</p>

      <footer class="site-footer">
        <span class="site-footer-owner"><a href="https://github.com/mj1856/SimpleImpersonation">SimpleImpersonation</a> is maintained by <a href="https://github.com/mj1856">mj1856</a>.</span>

        <span class="site-footer-credits">This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the <a href="https://github.com/jasonlong/cayman-theme">Cayman theme</a> by <a href="https://twitter.com/jasonlong">Jason Long</a>.</span>
      </footer>

    </section>

  
  </body>
</html>
